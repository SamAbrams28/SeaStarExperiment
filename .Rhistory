library(tidyverse)
all_sites <- read_csv("AllSites.csv")
setwd("/Users/samanthaabrams/Documents/MarinCS\ 100B/SeaStarExperiment")
all_sites <- read_csv("AllSites.csv")
View(all_sites)
all_sites <- read_csv("AllSites.csv")
all_sites$Combined_density <- all_sites$Purple_per_10m + all_sites$Orange_per_10m
View(all_sites)
pre_sswd <- all_sites[all_sites$Period == "Pre-SSWD", ]
density_vs_mortality <- pre_sswd %>%
group_by(Site) %>%
summarize(k = round(mean(Combined_density), 2), last_pre_density = last(Combined_density))
View(density_vs_mortality)
# I calculated these mortality rates last year.
density_vs_mortality$Mortality_rate <- c(87, 20, 83, 100, 100, 100, 91, 100, 92, 88, 85, 98)
write.csv(density_vs_mortality, file = "Density_Mortality_Comparison.csv", row.names = FALSE)
library(ggplot2)
setwd("/Users/samanthaabrams/Documents/MarinCS\ 100B/SeaStarExperiment")
density_mortality <- read.csv("Density_Mortality_Comparison.csv")
View(density_mortality)
ggplot(density_mortality, aes(last_pre_density, Mortality_rate)) +
geom_point() +
theme_bw()
ggplot(density_mortality, aes(k, Mortality_rate)) +
geom_point() +
theme_bw()
ggplot(density_mortality, aes(last_pre_density, Mortality_rate)) +
geom_point() +
labs(x = "Last density recorded before SSWD onset (individuals per 10m^2)",
y = "Orange Sea Stars per 10m^2") +
theme_bw()
ggplot(density_mortality, aes(last_pre_density, Mortality_rate)) +
geom_point() +
labs(x = "Last density recorded before SSWD onset (individuals per 10m^2)",
y = "Ochre Sea Star Mortality Rate (%)") +
theme_bw()
ggplot(density_mortality, aes(k, Mortality_rate)) +
geom_point() +
labs(x = "Pre-SSWD Average Population (individuals per 10m^2)",
y = "Ochre Sea Star Mortality Rate (%)") +
theme_bw()
all_species <- read.csv("AllSpecies_AllSites.csv")
View(all_species)
ggplot(all_species, aes(x = Site, y = Mussel_abundance)) +
geom_boxplot()
ggplot(all_species, aes(x = Site, y = Mussel_Abundance)) +
geom_boxplot()
ggplot(all_species, aes(x = Site, y = Mussel_Abundance)) +
geom_boxplot() +
scale_x_discrete(labels = label_wrap(18))
library(scales)
ggplot(all_species, aes(x = Site, y = Mussel_Abundance)) +
geom_boxplot() +
scale_x_discrete(labels = label_wrap(18))
ggplot(all_species, aes(x = Site, y = Mussel_Abundance)) +
geom_boxplot() +
scale_x_discrete(labels = label_wrap(11))
ggplot(all_species, aes(x = Site, y = Mussel_Abundance)) +
geom_boxplot() +
scale_x_discrete(labels = label_wrap(11)) +
theme_classic()
ggplot(all_species, aes(x = Site, y = Mussel_Abundance)) +
geom_boxplot() +
scale_x_discrete(labels = label_wrap(11)) +
theme_linedraw()
ggplot(all_species, aes(x = Site, y = Mussel_Abundance)) +
geom_boxplot() +
scale_x_discrete(labels = label_wrap(11)) +
theme_classic)
ggplot(all_species, aes(x = Site, y = Mussel_Abundance)) +
geom_boxplot() +
scale_x_discrete(labels = label_wrap(11)) +
theme_classic()
ggplot(all_species, aes(x = Site, y = Mussel_Abundance, color = Site)) +
geom_boxplot() +
scale_x_discrete(labels = label_wrap(11)) +
theme_classic()
ggplot(all_species, aes(x = Site, y = Mussel_Abundance, color = Site)) +
geom_boxplot() +
scale_x_discrete(labels = label_wrap(11)) +
guides(color = "none")
ggplot(all_species, aes(x = Site, y = Mussel_Abundance, color = Site)) +
geom_boxplot() +
scale_x_discrete(labels = label_wrap(11)) +
guides(color = "none") +
theme_classic()
library(tidyverse)
?pivot_longer
all_species[,ends_with("Abundance")]
?select
select[all_species, ends_with("Abundance")]
all_species %>%
select(ends_with("Abundance"))
by_species <- pivot_longer(all_species, c(ends_with("Abundance"), ends_with("10m")),
names_to = "Phenotype/Speices", values_to = "Density/Abundance")
View(by_species)
ggplot(by_species, aes(x = Site, y = Density/Abundance, group = `Phenotype/Speices`)) +
geom_boxplot() +
scale_x_discrete(labels = label_wrap(11)) +
guides(color = "none") +
theme_classic()
ggplot(by_species, aes(x = Site, y = Density/Abundance, group = Phenotype/Speices)) +
geom_boxplot() +
scale_x_discrete(labels = label_wrap(11)) +
guides(color = "none") +
theme_classic()
by_species <- pivot_longer(all_species, c(ends_with("Abundance"), ends_with("10m")),
names_to = "Phenotype_Speices", values_to = "Density_Abundance")
View(by_species)
ggplot(by_species, aes(x = Site, y = Density_Abundance, group = Phenotype_Speices)) +
geom_boxplot() +
scale_x_discrete(labels = label_wrap(11)) +
guides(color = "none") +
theme_classic()
by_species <- pivot_longer(all_species, c(ends_with("Abundance"), ends_with("Count")),
names_to = "Phenotype_Speices", values_to = "Density_Abundance")
View(by_species)
ggplot(by_species, aes(x = Site, y = Density_Abundance, group = Phenotype_Speices)) +
geom_boxplot() +
scale_x_discrete(labels = label_wrap(11)) +
guides(color = "none") +
theme_classic()
by_species <- by_species[,c(1,2,8,9)]
View(by_species)
ggplot(by_species, aes(x = Site, y = Density_Abundance, group = Phenotype_Speices)) +
geom_boxplot() +
scale_x_discrete(labels = label_wrap(11)) +
guides(color = "none") +
theme_classic()
ggplot(by_species, aes(x = Site, y = Density_Abundance)) +
geom_boxplot() +
scale_x_discrete(labels = label_wrap(11)) +
guides(color = "none") +
theme_classic()
ggplot(by_species, aes(x = Site, y = Density_Abundance)) +
geom_boxplot(group = Phenotype_Speices) +
scale_x_discrete(labels = label_wrap(11)) +
guides(color = "none") +
theme_classic()
ggplot(by_species, aes(x = Site, y = Density_Abundance)) +
geom_boxplot(group = Phenotype_Speices) +
scale_x_discrete(labels = label_wrap(11)) +
guides(color = "none") +
theme_classic()
by_species <- by_species[,c(1,2,8,9)]
long_format <- pivot_longer(all_species, c(ends_with("Abundance"), ends_with("Count")),
names_to = "Phenotype_Species", values_to = "Density_Abundance")
View(long_format)
by_species <- long_format[,c(1,2,8,9)]
View(by_species)
ggplot(by_species, aes(x = Site, y = Density_Abundance)) +
geom_boxplot(group = Phenotype_Species) +
scale_x_discrete(labels = label_wrap(11)) +
guides(color = "none") +
theme_classic()
ggplot(by_species, aes(x = Site, y = Density_Abundance)) +
geom_boxplot(aes(group = Phenotype_Species)) +
scale_x_discrete(labels = label_wrap(11)) +
guides(color = "none") +
theme_classic()
ggplot(by_species, aes(x = Site, y = Density_Abundance)) +
geom_boxplot(aes(group = interaction(Phenotype_Species, Site))) +
scale_x_discrete(labels = label_wrap(11)) +
guides(color = "none") +
theme_classic()
no_purple <- by_species[-c(by_species$Phenotype_Species == "Purple_Count"),]
no_purple <- by_species[c(by_species$Phenotype_Species != "Purple_Count"),]
ggplot(by_species, aes(x = Site, y = Density_Abundance)) +
geom_boxplot(aes(group = interaction(Phenotype_Species, Site))) +
scale_x_discrete(labels = label_wrap(11)) +
guides(color = "none") +
theme_classic()
ggplot(no_purple, aes(x = Site, y = Density_Abundance)) +
geom_boxplot(aes(group = interaction(Phenotype_Species, Site))) +
scale_x_discrete(labels = label_wrap(11)) +
guides(color = "none") +
theme_classic()
?max
View(no_purple)
ggplot(no_purple, aes(x = Site, y = Density_Abundance)) +
geom_boxplot(aes(group = interaction(Phenotype_Species, Site))) +
scale_x_discrete(labels = label_wrap(11)) +
scale_y_continuous(limit = c(0,30))
ggplot(no_purple, aes(x = Site, y = Density_Abundance)) +
geom_boxplot(aes(group = interaction(Phenotype_Species, Site))) +
scale_x_discrete(labels = label_wrap(11)) +
scale_y_continuous(limit = c(0,30)) +
guides(color = "none") +
theme_classic()
ggplot(no_purple, aes(x = Site, y = Density_Abundance)) +
geom_boxplot(aes(group = interaction(Phenotype_Species, Site))) +
scale_x_discrete(labels = label_wrap(11)) +
scale_y_continuous(limit = c(0,25)) +
theme_classic()
ggplot(no_purple, aes(x = Site, y = Density_Abundance)) +
geom_boxplot(aes(group = interaction(Phenotype_Species, Site))) +
scale_x_discrete(labels = label_wrap(11)) +
scale_y_continuous(limit = c(0,30)) +
theme_classic()
ggplot(no_purple, aes(x = Site, y = Density_Abundance, color = Site)) +
geom_boxplot(aes(group = interaction(Phenotype_Species, Site))) +
scale_x_discrete(labels = label_wrap(11)) +
scale_y_continuous(limit = c(0,30)) +
theme_classic()
ggplot(no_purple, aes(x = Site, y = Density_Abundance, color = Phenotype_Species)) +
geom_boxplot(aes(group = interaction(Phenotype_Species, Site))) +
scale_x_discrete(labels = label_wrap(11)) +
scale_y_continuous(limit = c(0,30)) +
theme_classic()
scale_x_discrete(labels = label_wrap(11)) +
scale_y_continuous(limit = c(0,30)) +
theme_classic()
ggplot(no_purple, aes(x = Site, y = Density_Abundance, color = Phenotype_Species)) +
geom_boxplot(aes(group = interaction(Phenotype_Species, Site))) +
scale_color_discrete(name = "Species", labels = c("Acorn Barnacles", "Mussels", "Orange Ochre Sea Stars")) +
scale_x_discrete(labels = label_wrap(11)) +
scale_y_continuous(limit = c(0,30)) +
theme_classic()
ggplot(no_purple, aes(x = Site, y = Density_Abundance, color = Phenotype_Species)) +
geom_boxplot(aes(group = interaction(Phenotype_Species, Site))) +
scale_color_discrete(name = "Species", labels = c("Acorn Barnacles", "Mussels", "Sea Stars")) +
scale_x_discrete(labels = label_wrap(11)) +
scale_y_continuous(limit = c(0,30)) +
theme_classic()
ggplot(no_purple, aes(x = Site, y = Density_Abundance, color = Phenotype_Species)) +
geom_boxplot(aes(group = interaction(Phenotype_Species, Site))) +
scale_color_discrete(name = "Species", labels = c("Acorn Barnacles", "Mussels", "Sea Stars")) +
scale_x_discrete(labels = label_wrap(11)) +
scale_y_continuous(limit = c(0,30)) +
theme_classic() +
theme(legend.position = "inside",
legend.position.inside = c(0.01, 0.99),
legend.justification = c(0, 1))
ggplot(no_purple, aes(x = Site, y = Density_Abundance, color = Phenotype_Species)) +
geom_boxplot(aes(group = interaction(Phenotype_Species, Site))) +
scale_color_discrete(name = "Species", labels = c("Acorn Barnacles", "Mussels", "Orange Ochre Sea Stars")) +
scale_x_discrete(labels = label_wrap(11)) +
scale_y_continuous(limit = c(0,30)) +
theme_classic() +
theme(legend.position = "inside",
legend.position.inside = c(0.01, 0.99),
legend.justification = c(0, 1))
ggplot(no_purple, aes(x = Site, y = Density_Abundance, color = Phenotype_Species)) +
geom_boxplot(aes(group = interaction(Phenotype_Species, Site))) +
scale_color_discrete(name = "Species", labels = c("Acorn Barnacle Abundance", "Mussel Abundance", "Orange Ochre Sea Star Count")) +
scale_x_discrete(labels = label_wrap(11)) +
scale_y_continuous(limit = c(0,30)) +
theme_classic() +
theme(legend.position = "inside",
legend.position.inside = c(0.01, 0.99),
legend.justification = c(0, 1))
View(all_species)
View(by_species)
View(long_format)
ggplot(no_purple, aes(x = Site, y = Density_Abundance, color = Phenotype_Species)) +
geom_boxplot(aes(group = interaction(Phenotype_Species, Site))) +
scale_color_discrete(name = "Species", labels = c("Acorn Barnacle Abundance", "Mussel Abundance", "Orange Ochre Sea Star Count")) +
scale_x_discrete(labels = label_wrap(11)) +
scale_y_continuous(limit = c(0,30), labels = "Count/Abundance") +
theme_classic() +
theme(legend.position = "inside",
legend.position.inside = c(0.01, 0.99),
legend.justification = c(0, 1))
ggplot(no_purple, aes(x = Site, y = Density_Abundance, color = Phenotype_Species)) +
geom_boxplot(aes(group = interaction(Phenotype_Species, Site))) +
scale_color_discrete(name = "Species", labels = c("Acorn Barnacle Abundance", "Mussel Abundance", "Orange Ochre Sea Star Count")) +
scale_x_discrete(labels = label_wrap(11)) +
scale_y_continuous(limit = c(0,30)) +
theme_classic() +
theme(legend.position = "inside",
legend.position.inside = c(0.01, 0.99),
legend.justification = c(0, 1))
ggplot(no_purple, aes(x = Site, y = Density_Abundance, color = Phenotype_Species)) +
geom_boxplot(aes(group = interaction(Phenotype_Species, Site))) +
scale_color_discrete(name = "Species", labels = c("Acorn Barnacle Abundance", "Mussel Abundance", "Orange Ochre Sea Star Count")) +
scale_x_discrete(labels = label_wrap(11)) +
scale_y_continuous(limit = c(0,30)) +
labs(y ="Count/Abundance") +
theme_classic() +
theme(legend.position = "inside",
legend.position.inside = c(0.01, 0.99),
legend.justification = c(0, 1))
ggplot(no_purple, aes(x = Site, y = Density_Abundance, color = Phenotype_Species)) +
geom_boxplot(aes(group = interaction(Phenotype_Species, Site))) +
scale_color_discrete(name = "Species", labels = c("Acorn Barnacle Abundance", "Mussel Abundance", "Orange Ochre Sea Star Count")) +
scale_x_discrete(labels = label_wrap(11)) +
scale_y_continuous(limit = c(0,30)) +
labs(y ="Count (total individuals)/Abundance (squares present/25 per 1/4m plot)") +
theme_classic() +
theme(legend.position = "inside",
legend.position.inside = c(0.01, 0.99),
legend.justification = c(0, 1))
ggplot(no_purple, aes(x = Site, y = Density_Abundance, color = Phenotype_Species)) +
geom_boxplot(aes(group = interaction(Phenotype_Species, Site))) +
scale_color_discrete(name = "Species", labels = c("Acorn Barnacle Abundance", "Mussel Abundance", "Orange Ochre Sea Star Count")) +
scale_x_discrete(labels = label_wrap(11)) +
scale_y_continuous(limit = c(0,30)) +
labs(y ="Count (total individuals)/Abundance (squares present per 1/4m plot)") +
theme_classic() +
theme(legend.position = "inside",
legend.position.inside = c(0.01, 0.99),
legend.justification = c(0, 1))
